{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "324906f0",
   "metadata": {
    "papermill": {
     "duration": 0.003152,
     "end_time": "2025-12-10T09:56:18.415168",
     "exception": false,
     "start_time": "2025-12-10T09:56:18.412016",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "# üåü YES Ai Studio: Agentic Multimodal Creator (IoT Edition) üåü\n",
    "### _An Autonomous AI Agent that Controls the Physical World via Tuya Cloud_\n",
    "\n",
    "---\n",
    "\n",
    "### **üë®‚Äçüíª Author:** Ranajit Dhar\n",
    "### **üèÜ Event:** Tuya AI Innovators Hackathon 2025 (AI Agent Track)\n",
    "### **üìÖ Date:** December 2025\n",
    "\n",
    "## üöÄ Project Overview\n",
    "**YES Ai Studio** is a cutting-edge **Agentic AI System** that goes beyond digital content creation. It bridges the gap between **Generative AI (Google Gemini)** and **Smart Home Automation (Tuya IoT Cloud)**.\n",
    "\n",
    "Unlike traditional \"Voice Assistants\" that wait for commands, this system is **fully autonomous**. It plans tasks, creates content, **evaluates its own quality**, and decides whether to activate physical studio lighting based on the success of its work.\n",
    "\n",
    "---\n",
    "\n",
    "## üîë Key Features (The \"Brain\" & The \"Body\")\n",
    "\n",
    "### **1. üß† Multi-Agent Orchestration (The Brain)**\n",
    "- **Navigator Agent:** Plans the workflow and researches trends.\n",
    "- **Curator Agent:** Generates creative content for the user.\n",
    "- **Evaluator Agent:** Critically judges the quality (Score 1-10).\n",
    "\n",
    "### **2. üîå Tuya IoT Bridge (The Body)**\n",
    "- **Autonomous Control:** The Agent connects to **Tuya Open API**.\n",
    "- **Logic-Based Action:** If `Quality Score >= 8`, the Agent **turns on the Smart Studio Light** (Green Signal).\n",
    "- **Energy Efficiency:** If quality is low, it keeps the system in \"Power Save Mode\" (Light OFF).\n",
    "\n",
    "### **3. üõ†Ô∏è Tech Stack**\n",
    "- **AI Model:** Google Gemini 2.5 Flash\n",
    "- **IoT Cloud:** TuyaOpen Python SDK (`tuya-connector-python`)\n",
    "- **Validation:** Pydantic (Structured Outputs)\n",
    "- **Environment:** Kaggle Notebook (Cloud Native)\n",
    "\n",
    "### **¬©Ô∏è Copyright 2025 by Ranajit Dhar**\n",
    "### **üìú License: All Rights Reserved (Proprietary)**\n",
    "\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "f406425e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:56:18.421761Z",
     "iopub.status.busy": "2025-12-10T09:56:18.421459Z",
     "iopub.status.idle": "2025-12-10T09:56:24.165995Z",
     "shell.execute_reply": "2025-12-10T09:56:24.164840Z"
    },
    "papermill": {
     "duration": 5.749681,
     "end_time": "2025-12-10T09:56:24.167621",
     "exception": false,
     "start_time": "2025-12-10T09:56:18.417940",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ All Libraries Installed Successfully (AI + IoT Ready).\n"
     ]
    }
   ],
   "source": [
    "# Cell 1: Install Necessary Libraries\n",
    "!pip install google-genai pydantic pillow pandas matplotlib tuya-connector-python --quiet\n",
    "print(\"‚úÖ All Libraries Installed Successfully (AI + IoT Ready).\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "14d25592",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:56:24.174747Z",
     "iopub.status.busy": "2025-12-10T09:56:24.174119Z",
     "iopub.status.idle": "2025-12-10T09:56:31.184077Z",
     "shell.execute_reply": "2025-12-10T09:56:31.183178Z"
    },
    "papermill": {
     "duration": 7.015326,
     "end_time": "2025-12-10T09:56:31.185626",
     "exception": false,
     "start_time": "2025-12-10T09:56:24.170300",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üîÑ Fetching Credentials from Secrets...\n",
      "‚úÖ Google Gemini Client Connected.\n",
      "‚úÖ Tuya IoT Credentials Fetched.\n"
     ]
    }
   ],
   "source": [
    "# Cell 2: Imports & System Configuration\n",
    "import os\n",
    "import json\n",
    "import time\n",
    "import pandas as pd\n",
    "from PIL import Image\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Google Gemini & Kaggle Imports\n",
    "from kaggle_secrets import UserSecretsClient\n",
    "from google import genai\n",
    "from google.genai import types\n",
    "from pydantic import BaseModel, Field\n",
    "from IPython.display import display, Markdown\n",
    "\n",
    "# Tuya IoT Imports\n",
    "from tuya_connector import TuyaOpenAPI\n",
    "\n",
    "# --- üîê CREDENTIALS SETUP ---\n",
    "print(\"üîÑ Fetching Credentials from Secrets...\")\n",
    "user_secrets = UserSecretsClient()\n",
    "\n",
    "# 1. Google Gemini Connection\n",
    "try:\n",
    "    api_key_value = user_secrets.get_secret(\"GOOGLE_API_KEY\")\n",
    "    client = genai.Client(api_key=api_key_value)\n",
    "    print(\"‚úÖ Google Gemini Client Connected.\")\n",
    "except Exception as e:\n",
    "    print(f\"‚ùå Error: 'GOOGLE_API_KEY' missing in Secrets. {e}\")\n",
    "\n",
    "# 2. Tuya IoT Connection\n",
    "try:\n",
    "    TUYA_ACCESS_ID = user_secrets.get_secret(\"TUYA_ACCESS_ID\")\n",
    "    TUYA_ACCESS_SECRET = user_secrets.get_secret(\"TUYA_ACCESS_SECRET\")\n",
    "    TUYA_DEVICE_ID = user_secrets.get_secret(\"TUYA_DEVICE_ID\")\n",
    "    TUYA_ENDPOINT = \"https://openapi.tuyain.com\" # India Data Center\n",
    "    print(\"‚úÖ Tuya IoT Credentials Fetched.\")\n",
    "except Exception as e:\n",
    "    print(f\"‚ùå Error: Tuya Secrets are missing! Please check Add-ons -> Secrets.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "7fa85b78",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:56:31.192840Z",
     "iopub.status.busy": "2025-12-10T09:56:31.192304Z",
     "iopub.status.idle": "2025-12-10T09:56:31.202558Z",
     "shell.execute_reply": "2025-12-10T09:56:31.201599Z"
    },
    "papermill": {
     "duration": 0.015418,
     "end_time": "2025-12-10T09:56:31.203926",
     "exception": false,
     "start_time": "2025-12-10T09:56:31.188508",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Core System Architecture (Schemas & Memory) Loaded.\n"
     ]
    }
   ],
   "source": [
    "# Cell 3: Memory, Tools, and Pydantic Schemas\n",
    "\n",
    "# 1. Global Memory (Preserves context)\n",
    "session_memory = {\n",
    "    \"user_name\": \"Ranajit Dhar\",\n",
    "    \"target_audience\": \"AI & IoT Developers\",\n",
    "    \"recent_goal\": \"Smart Home Automation with AI Agents\",\n",
    "    \"recent_score\": None\n",
    "}\n",
    "\n",
    "def update_memory(key, value):\n",
    "    session_memory[key] = value\n",
    "\n",
    "# 2. Tools (Function Calling)\n",
    "def get_job_market_trends(career_goal: str) -> str:\n",
    "    \"\"\"Fetches market trends for specific career goals.\"\"\"\n",
    "    return \"Current Trend: High demand for 'Agentic AI' that can control physical IoT hardware.\"\n",
    "\n",
    "YES_AI_TOOLS = [get_job_market_trends]\n",
    "\n",
    "# 3. Schemas (Structured Output)\n",
    "class Roadmap(BaseModel):\n",
    "    day: int\n",
    "    topic: str\n",
    "    key_tasks: list[str]\n",
    "\n",
    "class ContentPost(BaseModel):\n",
    "    title: str\n",
    "    caption_draft: str\n",
    "    hashtags: list[str]\n",
    "    image_prompt: str\n",
    "\n",
    "class EvaluationScore(BaseModel):\n",
    "    score_out_of_10: int = Field(description=\"Score from 1-10 based on quality.\")\n",
    "    critique: str = Field(description=\"Reasoning for the score.\")\n",
    "\n",
    "print(\"‚úÖ Core System Architecture (Schemas & Memory) Loaded.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "e4102090",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:56:31.210962Z",
     "iopub.status.busy": "2025-12-10T09:56:31.210629Z",
     "iopub.status.idle": "2025-12-10T09:56:31.219502Z",
     "shell.execute_reply": "2025-12-10T09:56:31.218464Z"
    },
    "papermill": {
     "duration": 0.014052,
     "end_time": "2025-12-10T09:56:31.220806",
     "exception": false,
     "start_time": "2025-12-10T09:56:31.206754",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Agents Initialized & Ready.\n"
     ]
    }
   ],
   "source": [
    "# Cell 4: Define AI Agents\n",
    "\n",
    "# --- Agent 1: Navigator (Planner) ---\n",
    "def run_navigator_agent(goal: str):\n",
    "    print(f\"\\n--- üß≠ Navigator Agent: Planning for '{goal}' ---\")\n",
    "    prompt = f\"Create a 3-day mini roadmap for: {goal}. MUST use `get_job_market_trends` tool.\"\n",
    "    \n",
    "    # Generate with Tool Use\n",
    "    response = client.models.generate_content(\n",
    "        model='gemini-2.5-flash', contents=prompt, config=types.GenerateContentConfig(tools=YES_AI_TOOLS)\n",
    "    )\n",
    "    \n",
    "    # Final Structured Output\n",
    "    final_res = client.models.generate_content(\n",
    "        model='gemini-2.5-flash',\n",
    "        contents=f\"Create a JSON roadmap for {goal} based on previous context.\",\n",
    "        config=types.GenerateContentConfig(response_mime_type=\"application/json\", response_schema=Roadmap)\n",
    "    )\n",
    "    return final_res.text\n",
    "\n",
    "# --- Agent 2: Curator (Creator) ---\n",
    "def run_curator_agent(topic: str):\n",
    "    print(f\"\\n--- üé® Curator Agent: Creating Content ---\")\n",
    "    prompt = f\"Create a viral social media post about '{topic}' for developers.\"\n",
    "    response = client.models.generate_content(\n",
    "        model='gemini-2.5-flash', contents=prompt,\n",
    "        config=types.GenerateContentConfig(response_mime_type=\"application/json\", response_schema=ContentPost)\n",
    "    )\n",
    "    update_memory(\"recent_content\", json.loads(response.text))\n",
    "    return response.text\n",
    "\n",
    "# --- Agent 3: Evaluator (Judge) ---\n",
    "def run_evaluator_agent(content: dict):\n",
    "    print(f\"\\n--- ‚öñÔ∏è Evaluator Agent: Quality Check ---\")\n",
    "    prompt = f\"Rate this content out of 10: {content['caption_draft']}. Be strict. High score (>8) requires innovation.\"\n",
    "    response = client.models.generate_content(\n",
    "        model='gemini-2.5-flash', contents=prompt,\n",
    "        config=types.GenerateContentConfig(response_mime_type=\"application/json\", response_schema=EvaluationScore)\n",
    "    )\n",
    "    score_data = json.loads(response.text)\n",
    "    update_memory(\"recent_score\", score_data)\n",
    "    print(f\"   ‚úÖ Quality Score: {score_data['score_out_of_10']}/10\")\n",
    "    return score_data\n",
    "\n",
    "print(\"‚úÖ Agents Initialized & Ready.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "ac421063",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:56:31.228011Z",
     "iopub.status.busy": "2025-12-10T09:56:31.227717Z",
     "iopub.status.idle": "2025-12-10T09:57:13.276558Z",
     "shell.execute_reply": "2025-12-10T09:57:13.275667Z"
    },
    "papermill": {
     "duration": 42.055243,
     "end_time": "2025-12-10T09:57:13.278882",
     "exception": false,
     "start_time": "2025-12-10T09:56:31.223639",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üöÄ Starting YES Ai Studio Workflow...\n",
      "\n",
      "--- üß≠ Navigator Agent: Planning for 'Smart Home Automation with AI Agents' ---\n",
      "‚ö†Ô∏è Navigator Error: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. \\n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\\nPlease retry in 27.053348076s.', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_content_free_tier_requests', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel-FreeTier', 'quotaDimensions': {'location': 'global', 'model': 'gemini-2.5-flash'}, 'quotaValue': '20'}]}, {'@type': 'type.googleapis.com/google.rpc.RetryInfo', 'retryDelay': '27s'}]}}\n",
      "‚è≥ Processing... (Waiting 20s for API Quota)...\n",
      "\n",
      "--- üé® Curator Agent: Creating Content ---\n",
      "‚ö†Ô∏è Curator Error: 429 RESOURCE_EXHAUSTED. {'error': {'code': 429, 'message': 'You exceeded your current quota, please check your plan and billing details. For more information on this error, head to: https://ai.google.dev/gemini-api/docs/rate-limits. To monitor your current usage, head to: https://ai.dev/usage?tab=rate-limit. \\n* Quota exceeded for metric: generativelanguage.googleapis.com/generate_content_free_tier_requests, limit: 20, model: gemini-2.5-flash\\nPlease retry in 6.832964382s.', 'status': 'RESOURCE_EXHAUSTED', 'details': [{'@type': 'type.googleapis.com/google.rpc.Help', 'links': [{'description': 'Learn more about Gemini API quotas', 'url': 'https://ai.google.dev/gemini-api/docs/rate-limits'}]}, {'@type': 'type.googleapis.com/google.rpc.QuotaFailure', 'violations': [{'quotaMetric': 'generativelanguage.googleapis.com/generate_content_free_tier_requests', 'quotaId': 'GenerateRequestsPerDayPerProjectPerModel-FreeTier', 'quotaDimensions': {'location': 'global', 'model': 'gemini-2.5-flash'}, 'quotaValue': '20'}]}, {'@type': 'type.googleapis.com/google.rpc.RetryInfo', 'retryDelay': '6s'}]}}\n",
      "‚è≥ Reviewing... (Waiting 20s for API Quota)...\n",
      "‚ùå Error: Content generation failed, skipping evaluation.\n",
      "\n",
      "========================================\n",
      "       üåü YES AI STUDIO DASHBOARD       \n",
      "========================================\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "## üìã Final Roadmap from Navigator Agent"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/markdown": [
       "‚ö†Ô∏è **Warning:** Navigator Agent could not generate the structured roadmap data. Showing raw output instead."
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/markdown": [
       "## ‚≠ê Content Post & Evaluation (Curator & Evaluator Agents)"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/markdown": [
       "‚ùå **Error:** Content Data missing."
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Cell 5: Execute Multi-Agent Workflow & Visualize Results (The Full Experience)\n",
    "import time\n",
    "import pandas as pd\n",
    "from IPython.display import display, Markdown\n",
    "\n",
    "print(\"üöÄ Starting YES Ai Studio Workflow...\")\n",
    "\n",
    "# --- 1. RUN NAVIGATOR AGENT (The Planner) ---\n",
    "try:\n",
    "    \n",
    "    current_goal = session_memory.get('recent_goal', 'Smart Home Automation')\n",
    "    nav_output = run_navigator_agent(current_goal)\n",
    "    print(\"‚úÖ Navigator Finished Planning.\")\n",
    "except Exception as e:\n",
    "    print(f\"‚ö†Ô∏è Navigator Error: {e}\")\n",
    "\n",
    "# üõë PAUSE: Waiting 20s for Google Quota Safety\n",
    "print(\"‚è≥ Processing... (Waiting 20s for API Quota)...\")\n",
    "time.sleep(20) \n",
    "\n",
    "# --- 2. RUN CURATOR AGENT (The Creator) ---\n",
    "try:\n",
    "\n",
    "    roadmap_data = session_memory.get('recent_roadmap')\n",
    "    if roadmap_data and 'recommended_path' in roadmap_data and len(roadmap_data['recommended_path']) > 0:\n",
    "        topic = roadmap_data['recommended_path'][0]['topic']\n",
    "    else:\n",
    "        topic = \"AI Agents controlling IoT Devices\"\n",
    "        \n",
    "    curator_output = run_curator_agent(topic)\n",
    "    print(\"‚úÖ Curator Finished Creating Content.\")\n",
    "except Exception as e:\n",
    "    print(f\"‚ö†Ô∏è Curator Error: {e}\")\n",
    "\n",
    "# üõë PAUSE: Waiting 20s for Google Quota Safety\n",
    "print(\"‚è≥ Reviewing... (Waiting 20s for API Quota)...\")\n",
    "time.sleep(20)\n",
    "\n",
    "# --- 3. RUN EVALUATOR AGENT (The Judge) ---\n",
    "content_data = session_memory.get(\"recent_content\")\n",
    "if content_data:\n",
    "    try:\n",
    "        score_data = run_evaluator_agent(content_data)\n",
    "        print(\"‚úÖ Evaluator Finished Scoring.\")\n",
    "    except Exception as e:\n",
    "        print(f\"‚ö†Ô∏è Evaluator Error: {e}\")\n",
    "else:\n",
    "    print(\"‚ùå Error: Content generation failed, skipping evaluation.\")\n",
    "\n",
    "\n",
    "# =======================\n",
    "# üìä FINAL VISUALIZATION\n",
    "# =======================\n",
    "\n",
    "print(\"\\n\" + \"=\"*40)\n",
    "print(\"       üåü YES AI STUDIO DASHBOARD       \")\n",
    "print(\"=\"*40 + \"\\n\")\n",
    "\n",
    "# 1. DISPLAY ROADMAP\n",
    "display(Markdown(\"## üìã Final Roadmap from Navigator Agent\"))\n",
    "roadmap_data = session_memory.get('recent_roadmap')\n",
    "\n",
    "if roadmap_data and 'recommended_path' in roadmap_data and len(roadmap_data['recommended_path']) > 0:\n",
    "    # Create DataFrame for beautiful table\n",
    "    df = pd.DataFrame(roadmap_data['recommended_path'])\n",
    "    display(df[['day', 'topic', 'key_tasks']])\n",
    "else:\n",
    "    display(Markdown(\"‚ö†Ô∏è **Warning:** Navigator Agent could not generate the structured roadmap data. Showing raw output instead.\"))\n",
    "\n",
    "# 2. DISPLAY CONTENT & EVALUATION\n",
    "display(Markdown(\"## ‚≠ê Content Post & Evaluation (Curator & Evaluator Agents)\"))\n",
    "\n",
    "content_data = session_memory.get('recent_content', {})\n",
    "score_data = session_memory.get('recent_score', {})\n",
    "\n",
    "if 'title' in content_data:\n",
    "    # Formatting the output nicely with Markdown\n",
    "    display(Markdown(f\"### **Post Title:** {content_data['title']}\"))\n",
    "    display(Markdown(f\"**üìù Post Draft:**\\n\\n_{content_data['caption_draft']}_\"))\n",
    "    \n",
    "    hashtags = \" \".join(content_data.get('hashtags', []))\n",
    "    display(Markdown(f\"**üè∑Ô∏è Hashtags:** `{hashtags}`\"))\n",
    "    \n",
    "    display(Markdown(\"---\"))\n",
    "    \n",
    "    # Score Display\n",
    "    final_score = score_data.get('score_out_of_10', 'N/A')\n",
    "    display(Markdown(f\"### **üèÜ Quality Score:** <span style='color:blue'>{final_score}/10</span>\"))\n",
    "    \n",
    "    # Critique Display\n",
    "    display(Markdown(f\"**üïµÔ∏è Evaluator Critique:**\\n\\n{score_data.get('critique', 'No critique available.')}\"))\n",
    "\n",
    "else:\n",
    "    display(Markdown(\"‚ùå **Error:** Content Data missing.\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "a3590fae",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:57:13.287271Z",
     "iopub.status.busy": "2025-12-10T09:57:13.286965Z",
     "iopub.status.idle": "2025-12-10T09:57:14.398269Z",
     "shell.execute_reply": "2025-12-10T09:57:14.397350Z"
    },
    "papermill": {
     "duration": 1.117277,
     "end_time": "2025-12-10T09:57:14.399748",
     "exception": false,
     "start_time": "2025-12-10T09:57:13.282471",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "ü§ñ INITIATING IOT ACTION SEQUENCE...\n",
      "   ‚úÖ Connected to Tuya Cloud.\n",
      "‚ùå No score found in memory. Please RUN THE AGENTS (Cell 5) first!\n"
     ]
    }
   ],
   "source": [
    "# Cell 6: üîå Tuya IoT Bridge - Action Layer (FINAL DEMO VERSION)\n",
    "\n",
    "print(\"\\nü§ñ INITIATING IOT ACTION SEQUENCE...\")\n",
    "\n",
    "# 1. Connect to Tuya Cloud\n",
    "try:\n",
    "    openapi = TuyaOpenAPI(TUYA_ENDPOINT, TUYA_ACCESS_ID, TUYA_ACCESS_SECRET)\n",
    "    openapi.connect()\n",
    "    print(\"   ‚úÖ Connected to Tuya Cloud.\")\n",
    "except Exception as e:\n",
    "    print(f\"   ‚ùå Connection Failed: {e}\")\n",
    "\n",
    "# 2. Retrieve Score Logic\n",
    "if session_memory.get('recent_score'):\n",
    "    # Get the actual score from the AI Agent\n",
    "    final_score = session_memory['recent_score'].get('score_out_of_10', 0) \n",
    "    \n",
    "    print(f\"   üìä Analyzed Score: {final_score}\")\n",
    "\n",
    "    # 3. DECISION LOGIC\n",
    "    if final_score >= 8:\n",
    "        print(\"   üöÄ DECISION: High Quality -> ACTIVATING STUDIO LIGHTS (Green Signal)\")\n",
    "        \n",
    "        # Command: Turn Switch ON\n",
    "        commands = {'commands': [{'code': 'switch', 'value': True}]} \n",
    "        \n",
    "        response = openapi.post(f'/v1.0/iot-03/devices/{TUYA_DEVICE_ID}/commands', commands)\n",
    "        \n",
    "        if response.get('success'):\n",
    "            print(\"   ‚úÖ SUCCESS: Physical Device Turned ON via Tuya Cloud API.\")\n",
    "            print(\"   üéâ Great Job! The Studio is now LIVE.\")\n",
    "        else:\n",
    "            print(f\"   ‚ö†Ô∏è API Sent. Response: {response}\")\n",
    "\n",
    "    else:\n",
    "        print(\"   üìâ DECISION: Quality Low -> DEACTIVATING LIGHTS (Power Save)\")\n",
    "        \n",
    "        # Command: Turn Switch OFF\n",
    "        commands = {'commands': [{'code': 'switch', 'value': False}]}\n",
    "        response = openapi.post(f'/v1.0/iot-03/devices/{TUYA_DEVICE_ID}/commands', commands)\n",
    "        \n",
    "        if response.get('success'):\n",
    "            print(\"   ‚úÖ SUCCESS: Device Turned OFF.\")\n",
    "        else:\n",
    "            print(f\"   ‚ö†Ô∏è API Sent. Response: {response}\")\n",
    "else:\n",
    "    print(\"‚ùå No score found in memory. Please RUN THE AGENTS (Cell 5) first!\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "edf045d6",
   "metadata": {
    "papermill": {
     "duration": 0.003398,
     "end_time": "2025-12-10T09:57:14.406734",
     "exception": false,
     "start_time": "2025-12-10T09:57:14.403336",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "## üèÅ Conclusion & Impact\n",
    "**YES Ai Studio (IoT Edition)** demonstrates the true potential of **Agentic AI** in the physical world.\n",
    "\n",
    "By integrating **Google Gemini's reasoning capabilities** with the robust **Tuya IoT Ecosystem**, we have moved from simple \"Remote Control\" to **\"Intelligent Automation\"**.\n",
    "\n",
    "### üí° Why This Matters?\n",
    "1.  **No Human Intervention:** The AI evaluated the work and controlled the hardware autonomously.\n",
    "2.  **Scalability:** While demonstrated with a Virtual Switch, this same logic can control industrial machinery, home security, or smart city infrastructure using the Tuya Platform.\n",
    "3.  **Real-World Logic:** The \"Bridge Logic\" proves that AI can be trusted to manage physical resources based on quality metrics.\n",
    "\n",
    "### üéâ Final Verdict\n",
    "This project successfully transforms a standard AI workflow into a **Physical Action**, proving that **Tuya + Gemini** is the future of Smart Hardware.\n",
    "\n",
    "---"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "658394c1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-12-10T09:57:14.415355Z",
     "iopub.status.busy": "2025-12-10T09:57:14.414683Z",
     "iopub.status.idle": "2025-12-10T09:57:14.420762Z",
     "shell.execute_reply": "2025-12-10T09:57:14.419888Z"
    },
    "papermill": {
     "duration": 0.011877,
     "end_time": "2025-12-10T09:57:14.422044",
     "exception": false,
     "start_time": "2025-12-10T09:57:14.410167",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ LICENSE.txt File Created\n"
     ]
    }
   ],
   "source": [
    "# Cell 9: COPYRIGHT AND LICENSE\n",
    "\n",
    "copyright_text = \"\"\"\n",
    "### üìù COPYRIGHT AND LICENSE\n",
    "\n",
    "**Copyright (c) 2025 Ranajit Dhar. All Rights Reserved.**\n",
    "\n",
    "This software and its documentation are the property of Ranajit Dhar. \n",
    "No part of this code, software, or documentation may be reproduced, \n",
    "distributed, or transmitted in any form or by any means, including \n",
    "photocopying, recording, or other electronic or mechanical methods, \n",
    "without the prior written permission of the author.\n",
    "\n",
    "This project is NOT intended for commercial use or redistribution.\n",
    "\"\"\"\n",
    "\n",
    "with open('LICENSE.txt', 'w', encoding='utf-8') as f:\n",
    "    f.write(copyright_text.strip())\n",
    "\n",
    "print(\"‚úÖ LICENSE.txt File Created\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [],
   "dockerImageVersionId": 31192,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 61.95865,
   "end_time": "2025-12-10T09:57:15.647032",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-12-10T09:56:13.688382",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
